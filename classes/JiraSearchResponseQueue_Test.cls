@isTest
public class JiraSearchResponseQueue_Test{
                  static testMethod void test_execute_positive(){
                      Test.startTest();
                      Jira_User_Account__c jiraUserAccount = new Jira_User_Account__c(Email_Address__c = 'sfadmin@demandblue.com', 
                                                                                      Jira_User_Account_Id__c = '5b03dc8556a',
                                                                                      Name = 'DemandBlue Jira Admin');
                      insert jiraUserAccount;
                      
                      List<JIRA_Issue_Key__c> JIK = new List<JIRA_Issue_Key__c>();    
                      JIRA_Issue_Key__c obj1=new JIRA_Issue_Key__c(Key_Name__c = 'test', Jira_User_Account__c = jiraUserAccount.Id,
                                                                   Request_Body__c='{"timestamp":1567169833616,"webhookEvent":"jira:issue_created","issue_event_type_name":"issue_created","user":{"self":"https://demandblue.atlassian.net/rest/api/2/user?accountId=5b03dc8556a","name":"yuvaraj","key":"yuvaraj","accountId":"5b03dc8556a","emailAddress":"yuvaraj@preludesys.com","displayName":"Yuvaraj M","active":true,"timeZone":"America/Los_Angeles","accountType":"atlassian"},"issue":{"id":"15102","self":"https://demandblue.atlassian.net/rest/api/2/issue/15102","key":"DL-21","fields":{"statuscategorychangedate":"2019-08-30T05:57:13.765-0700","issuetype":{"self":"https://demandblue.atlassian.net/rest/api/2/issuetype/10001","id":"10001","description":"A user story. Created by Jira Software - do not edit or delete.","iconUrl":"https://demandblue.atlassian.net/secure/viewavatar?size=medium&avatarId=10315&avatarType=issuetype","name":"Story","subtask":false,"avatarId":10315},"reporter":{"self":"https://demandblue.atlassian.net/rest/api/2/user?accountId=5b03dc8556a","name":"yuvaraj","key":"yuvaraj","accountId":"5b03dc8556a","emailAddress":"yuvaraj@preludesys.com","displayName":"Yuvaraj M","active":true,"timeZone":"America/Los_Angeles","accountType":"atlassian"},"timespent":null,"project":{"self":"https://demandblue.atlassian.net/rest/api/2/project/10050","id":"10050","key":"DL","name":"DemandBlue Labs","projectTypeKey":"software","simplified":false},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"resolutiondate":null,"workratio":0,"lastViewed":null,"watches":{"self":"https://demandblue.atlassian.net/rest/api/2/issue/DL-21/watchers","watchCount":0,"isWatching":true},"created":"2019-08-30T05:57:13.551-0700","customfield_10140":null,"customfield_10141":null,"customfield_10142":null,"priority":{"self":"https://demandblue.atlassian.net/rest/api/2/priority/3","iconUrl":"https://demandblue.atlassian.net/images/icons/priorities/medium.svg","name":"Medium","id":"3"},"labels":["webhook"],"customfield_10138":null,"customfield_10139":null,"customfield_10018":null,"aggregatetimeoriginalestimate":3600,"timeestimate":3600,"versions":[],"issuelinks":[],"assignee":{"self":"https://demandblue.atlassian.net/rest/api/2/user?accountId=5b03dc8556a","name":"yuvaraj","key":"yuvaraj","accountId":"5b03dc8556a","emailAddress":"yuvaraj@preludesys.com","displayName":"Yuvaraj M","active":true,"timeZone":"America/Los_Angeles","accountType":"atlassian"},"updated":"2019-08-30T05:57:13.551-0700","status":{"self":"https://demandblue.atlassian.net/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://demandblue.atlassian.net/images/icons/statuses/open.png","name":"New","id":"1","statusCategory":{"self":"https://demandblue.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"components":[],"timeoriginalestimate":3600,"description":null,"customfield_10131":null,"customfield_10010":null,"customfield_10011":"1|i00lar:","customfield_10132":null,"customfield_10012":null,"customfield_10133":null,"customfield_10134":[],"customfield_10013":null,"customfield_10014":null,"timetracking":{"originalEstimate":"1h","remainingEstimate":"1h","originalEstimateSeconds":3600,"remainingEstimateSeconds":3600},"security":null,"customfield_10008":null,"customfield_10009":{"hasEpicLinkFieldDependency":false,"showField":false,"nonEditableReason":{"reason":"PLUGIN_LICENSE_ERROR","message":"Portfolio for Jira must be licensed for the Parent Link to be available."}},"aggregatetimeestimate":3600,"attachment":[],"summary":"Sample Webhook Request","creator":{"self":"https://demandblue.atlassian.net/rest/api/2/user?accountId=5b03dc8556a","name":"yuvaraj","key":"yuvaraj","accountId":"5b03dc8556a","emailAddress":"yuvaraj@preludesys.com","displayName":"Yuvaraj M","active":true,"timeZone":"America/Los_Angeles","accountType":"atlassian"},"subtasks":[],"reporter":{"self":"https://demandblue.atlassian.net/rest/api/2/user?accountId=5b03dc8556a","name":"yuvaraj","key":"yuvaraj","accountId":"5b03dc8556a","emailAddress":"yuvaraj@preludesys.com","displayName":"Yuvaraj M","active":true,"timeZone":"America/Los_Angeles","accountType":"atlassian"},"aggregateprogress":{"progress":0,"total":3600,"percent":0},"customfield_10000":"{}","customfield_10001":null,"customfield_10004":null,"environment":null,"duedate":null,"progress":{"progress":0,"total":3600,"percent":0},"votes":{"self":"https://demandblue.atlassian.net/rest/api/2/issue/DL-21/votes","votes":0,"hasVoted":false}}},"changelog":{"id":"31094","items":[{"field":"assignee","fieldtype":"jira","fieldId":"assignee","from":null,"fromString":null,"to":"yuvaraj","toString":"Yuvaraj M","tmpFromAccountId":null,"tmpToAccountId":"5b03dc8556a"},{"field":"priority","fieldtype":"jira","fieldId":"priority","from":null,"fromString":null,"to":"3","toString":"Medium"},{"field":"reporter","fieldtype":"jira","fieldId":"reporter","from":null,"fromString":null,"to":"yuvaraj","toString":"Yuvaraj M","tmpFromAccountId":null,"tmpToAccountId":"5b03dc8556a"},{"field":"Status","fieldtype":"jira","fieldId":"status","from":null,"fromString":null,"to":"1","toString":"New"},{"field":"summary","fieldtype":"jira","fieldId":"summary","from":null,"fromString":null,"to":null,"toString":"Sample Webhook Request"}]}}}',
                                                                   Jira_Search_Response__c='{"expand":"schema,names","startAt":0,"maxResults":50,"total":3,"issues":[{"expand":"operations,versionedRepresentations,editmeta,changelog,renderedFields","id":"15102","self":"https://demandblue.atlassian.net/rest/api/3/issue/15102","key":"DL-21","fields":{"summary":"Sample Webhook Request","assignee":{"self":"https://demandblue.atlassian.net/rest/api/3/user?accountId=5b03dc8556a","name":"yuvaraj","key":"yuvaraj","accountId":"5b03dc8556a","displayName":"Yuvaraj M","active":true,"timeZone":"America/Los_Angeles","accountType":"atlassian"},"status":{"self":"https://demandblue.atlassian.net/rest/api/3/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://demandblue.atlassian.net/images/icons/statuses/open.png","name":"New","id":"1","statusCategory":{"self":"https://demandblue.atlassian.net/rest/api/3/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}}}},{"expand":"operations,versionedRepresentations,editmeta,changelog,renderedFields","id":"15101","self":"https://demandblue.atlassian.net/rest/api/3/issue/15101","key":"DL-20","fields":{"summary":"Sample Webhook Request","assignee":null,"status":{"self":"https://demandblue.atlassian.net/rest/api/3/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://demandblue.atlassian.net/images/icons/statuses/open.png","name":"New","id":"1","statusCategory":{"self":"https://demandblue.atlassian.net/rest/api/3/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}}}},{"expand":"operations,versionedRepresentations,editmeta,changelog,renderedFields","id":"14678","self":"https://demandblue.atlassian.net/rest/api/3/issue/14678","key":"DL-8","fields":{"summary":"Test Webhook #3","assignee":null,"status":{"self":"https://demandblue.atlassian.net/rest/api/3/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://demandblue.atlassian.net/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://demandblue.atlassian.net/rest/api/3/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}}}}],"names":{"summary":"Summary","assignee":"Assignee","status":"Status"},"schema":{"summary":{"type":"string","system":"summary"},"assignee":{"type":"user","system":"assignee"},"status":{"type":"status","system":"status"}}}',
                                                                  Is_Search_Processed__c=true);
                      JIK.add(obj1);
                      insert JIK;
                      id recordid=JIK[0].Id;

                      Mockhttpresponse res= new Mockhttpresponse();
                      JiraSearchResponseQueue obj = new JiraSearchResponseQueue(recordid);
                      List<JIRA_Issue_Key__c> j =  [SELECT Key_Name__c,Request_Body__c,Is_Search_Processed__c,Jira_Search_Response__c from JIRA_Issue_Key__c WHERE Id = : recordid];
                      try{
                                                system.enqueueJob(obj);
                          
                      }
                      Catch(Exception e)
                      {
                          system.debug(e.getMessage());
                      }
                      
                      System.assertEquals(true,j.size()>0);  
                      
        Test.stopTest();
                      
                  }
    
                    static testMethod void test_execute_negative(){                                       
                      Test.startTest();
                      Jira_User_Account__c jiraUserAccount = new Jira_User_Account__c(Email_Address__c = 'sfadmin@demandblue.com', 
                                                                                      Jira_User_Account_Id__c = '5b03dc8556a',
                                                                                      Name = 'DemandBlue Jira Admin');
                      insert jiraUserAccount;

                      List<JIRA_Issue_Key__c> JIK = new List<JIRA_Issue_Key__c>();    
                      JIRA_Issue_Key__c obj1=new JIRA_Issue_Key__c(Key_Name__c = 'test', Jira_User_Account__c = jiraUserAccount.Id,
                                                                   Request_Body__c='{"timestamp":1567169833616,"webhookEvent":"jira:issue_created","issue_event_type_name":"issue_created","user":{"self":"https://demandblue.atlassian.net/rest/api/2/user?accountId=5b03dc8556a","name":"yuvaraj","key":"yuvaraj","accountId":"5b03dc8556a","emailAddress":"yuvaraj@preludesys.com","displayName":"Yuvaraj M","active":true,"timeZone":"America/Los_Angeles","accountType":"atlassian"},"issue":{"id":"15102","self":"https://demandblue.atlassian.net/rest/api/2/issue/15102","key":"DL-21","fields":{"statuscategorychangedate":"2019-08-30T05:57:13.765-0700","issuetype":{"self":"https://demandblue.atlassian.net/rest/api/2/issuetype/10001","id":"10001","description":"A user story. Created by Jira Software - do not edit or delete.","iconUrl":"https://demandblue.atlassian.net/secure/viewavatar?size=medium&avatarId=10315&avatarType=issuetype","name":"Story","subtask":false,"avatarId":10315},"reporter":{"self":"https://demandblue.atlassian.net/rest/api/2/user?accountId=5b03dc8556a","name":"yuvaraj","key":"yuvaraj","accountId":"5b03dc8556a","emailAddress":"yuvaraj@preludesys.com","displayName":"Yuvaraj M","active":true,"timeZone":"America/Los_Angeles","accountType":"atlassian"},"timespent":null,"project":{"self":"https://demandblue.atlassian.net/rest/api/2/project/10050","id":"10050","key":"DL","name":"DemandBlue Labs","projectTypeKey":"software","simplified":false},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"resolutiondate":null,"workratio":0,"lastViewed":null,"watches":{"self":"https://demandblue.atlassian.net/rest/api/2/issue/DL-21/watchers","watchCount":0,"isWatching":true},"created":"2019-08-30T05:57:13.551-0700","customfield_10140":null,"customfield_10141":null,"customfield_10142":null,"priority":{"self":"https://demandblue.atlassian.net/rest/api/2/priority/3","iconUrl":"https://demandblue.atlassian.net/images/icons/priorities/medium.svg","name":"Medium","id":"3"},"labels":["webhook"],"customfield_10138":null,"customfield_10139":null,"customfield_10018":null,"aggregatetimeoriginalestimate":3600,"timeestimate":3600,"versions":[],"issuelinks":[],"assignee":{"self":"https://demandblue.atlassian.net/rest/api/2/user?accountId=5b03dc8556a","name":"yuvaraj","key":"yuvaraj","accountId":"5b03dc8556a","emailAddress":"yuvaraj@preludesys.com","displayName":"Yuvaraj M","active":true,"timeZone":"America/Los_Angeles","accountType":"atlassian"},"updated":"2019-08-30T05:57:13.551-0700","status":{"self":"https://demandblue.atlassian.net/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://demandblue.atlassian.net/images/icons/statuses/open.png","name":"New","id":"1","statusCategory":{"self":"https://demandblue.atlassian.net/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"components":[],"timeoriginalestimate":3600,"description":null,"customfield_10131":null,"customfield_10010":null,"customfield_10011":"1|i00lar:","customfield_10132":null,"customfield_10012":null,"customfield_10133":null,"customfield_10134":[],"customfield_10013":null,"customfield_10014":null,"timetracking":{"originalEstimate":"1h","remainingEstimate":"1h","originalEstimateSeconds":3600,"remainingEstimateSeconds":3600},"security":null,"customfield_10008":null,"customfield_10009":{"hasEpicLinkFieldDependency":false,"showField":false,"nonEditableReason":{"reason":"PLUGIN_LICENSE_ERROR","message":"Portfolio for Jira must be licensed for the Parent Link to be available."}},"aggregatetimeestimate":3600,"attachment":[],"summary":"Sample Webhook Request","creator":{"self":"https://demandblue.atlassian.net/rest/api/2/user?accountId=5b03dc8556a","name":"yuvaraj","key":"yuvaraj","accountId":"5b03dc8556a","emailAddress":"yuvaraj@preludesys.com","displayName":"Yuvaraj M","active":true,"timeZone":"America/Los_Angeles","accountType":"atlassian"},"subtasks":[],"reporter":{"self":"https://demandblue.atlassian.net/rest/api/2/user?accountId=5b03dc8556a","name":"yuvaraj","key":"yuvaraj","accountId":"5b03dc8556a","emailAddress":"yuvaraj@preludesys.com","displayName":"Yuvaraj M","active":true,"timeZone":"America/Los_Angeles","accountType":"atlassian"},"aggregateprogress":{"progress":0,"total":3600,"percent":0},"customfield_10000":"{}","customfield_10001":null,"customfield_10004":null,"environment":null,"duedate":null,"progress":{"progress":0,"total":3600,"percent":0},"votes":{"self":"https://demandblue.atlassian.net/rest/api/2/issue/DL-21/votes","votes":0,"hasVoted":false}}},"changelog":{"id":"31094","items":[{"field":"assignee","fieldtype":"jira","fieldId":"assignee","from":null,"fromString":null,"to":"yuvaraj","toString":"Yuvaraj M","tmpFromAccountId":null,"tmpToAccountId":"5b03dc8556a"},{"field":"priority","fieldtype":"jira","fieldId":"priority","from":null,"fromString":null,"to":"3","toString":"Medium"},{"field":"reporter","fieldtype":"jira","fieldId":"reporter","from":null,"fromString":null,"to":"yuvaraj","toString":"Yuvaraj M","tmpFromAccountId":null,"tmpToAccountId":"5b03dc8556a"},{"field":"Status","fieldtype":"jira","fieldId":"status","from":null,"fromString":null,"to":"1","toString":"New"},{"field":"summary","fieldtype":"jira","fieldId":"summary","from":null,"fromString":null,"to":null,"toString":"Sample Webhook Request"}]}}}',
                                                                   Jira_Search_Response__c='{"expand":"schema,names","startAt":0,"maxResults":50,"total":3,"issues":[],"names":{"summary":"Summary","assignee":"Assignee","status":"Status"},"schema":{"summary":{"type":"string","system":"summary"},"assignee":{"type":"user","system":"assignee"},"status":{"type":"status","system":"status"}}}',
                                                                  Is_Search_Processed__c=true);
                      JIK.add(obj1);
                      insert JIK;
                      id recordid=JIK[0].Id;

                      Mockhttpresponse res= new Mockhttpresponse();
                      JiraSearchResponseQueue obj = new JiraSearchResponseQueue(recordid);
                      List<JIRA_Issue_Key__c> j =  [SELECT Key_Name__c,Request_Body__c,Is_Search_Processed__c,Jira_Search_Response__c from JIRA_Issue_Key__c WHERE Id = : recordid];
                      
                                                system.enqueueJob(obj);
                          //System.assertEquals(true,j.size()>0); 
                        try{
                                     JIRA_Issue_Key__c obj11=new JIRA_Issue_Key__c();

                                list<object> matchingIssues = new list<object>();
                                //JiraSearchResponseQueue.processSearchResponse(matchingIssues, obj11);
                             } Catch(Exception e)
                                     {
                                         system.debug(e.getMessage());
                                        }
        				Test.stopTest();                                  
                    } 

}